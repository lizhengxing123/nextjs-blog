---
title: '网络基础'
excerpt: '网络基础'
coverImage: '/assets/blog/python/socket.png'
date: '2023-06-20 14:37:41'
author:
  name: 李正星
  picture: '/assets/blog/authors/zx.jpeg'
ogImage:
  url: '/assets/blog/python/socket.png'
type: 'Python'
---

## 网络基础

### OSI 七层模型

#### 1、物理层

解决信号转换的问题

#### 2、数据链路层

解决发给谁的问题

> `mac` 地址：全世界唯一，相当于“身份证号”

#### 3、网络层

解决发送到哪里的问题

> `ip` 地址
> 
>   公网 `ip`：全世界唯一，相当于快递地址
> 
>   内网 `ip`：局域网唯一，相当于房间号

#### 4、传输层

解决用什么方式发的问题

> `tcp` 协议：可靠，但是速度慢（每发送一个包都要进行确认，没收到会进行补发），适合长距离传输
>
> `udp` 协议：不可靠，速度快，适合短距离传输
>
> 端口号

#### 5、会话层

决定什么时候开始发，什么时候开始断

#### 6、表示层

描述文件类型

#### 7、应用层

各种应用，如QQ、微信

### TCP/IP 协议五层模型

#### 1、物理层

其中一组数据称之为一个 `bit` 流

#### 2、数据链路层

- 以太网协议

一组数据称之为一个数据帧，一个数据帧分为两部分：

```python
"""
（头部）-------------------------------------（数据）
（发送者mac地址、接收者mac地址、类型（如ipv4））--（网络层所有内容）
（6字节、6字节、2字节）------------------------（最大1500字节）
"""
```

- 以太网帧格式

![以太网帧格式](/assets/blog/python/socket1.jpg)

- 工作方式：广播

#### 3、网络层

- `ip` 协议

一组数据称之为一个数据包，一个数据包分为两部分：

```python
"""
（头部）----------------------------（数据）
（发送者ip地址、接收者ip地址、类型）----（传输层所有内容）
"""
```

- `ip` 地址：`ipv4`

```python
"""
范围：0.0.0.0 ~ 255.255.255.255

内网 ip：

1. 10.0.0.0 ~ 10.255.255.255
2. 172.16.0.0 ~ 172.31.255.255
3. 192.168.0.0 ~ 192.168.255.255

保留地址：172.16.0.0 ~ 172.31.255.255
"""
```

- 子网掩码

必须配合 `ip` 地址一起使用

```python
"""
例如：192.168.2.13/255.255.255.0

255.255.255.0  ----->  11111111.11111111.11111111.00000000

192.168.2.13   ----->  11000000.10101000.00000010.00001101
                       [          网络位         ] [ 主机位 ]

子网掩码是控制网络位的，网络位相同的 `ip` 地址，它们就属于同一个网段。
其中是 `1` 的不变，是 `0` 的开始变。

所以范围是：
192.168.2.0     ----> 网络号
192.168.2.1     ----> 第一个可用
。。。
192.168.2.254   ----> 最后一个可用
192.168.2.255   ----> 广播地址
"""
```

- `ARP` 协议

根据 `ip` 地址获取 `mac` 地址

#### 4、传输层

- `tcp/udp`

头部 + 数据都包含源端口、目标端口和数据段的序列号

- `tcp` 6中标识

1. 握手包 `SYN`
2. 挥手包 `FIN`
3. 数据包 `PSH`
4. 确认包 `ACK`
5. 重发包 `RST`
6. 紧急包 `URG`

- `tcp` 三次握手

序列号 `seq`，确认序列号 `ack`

```python
"""
客户端 ---- [SYN] seq=x               ---> 服务端
客户端 <--- [SYN, ACK] seq=y, ack=x+1 ---- 服务端
客户端 ---- [ACK] seq=x+1, ack=y+1    ---> 服务端
"""
```

- `tcp` 四次挥手

```python
"""
客户端 ---- [FIN, ACK] seq=x, ack=y   ---> 服务端
客户端 <--- [ACK] seq=y, ack=x+1      ---- 服务端
。。。 等待服务端数据传输完成 。。。
客户端 <--- [FIN, ACK] seq=y, ack=x+1 ---- 服务端
客户端 ---- [ACK] seq=x+1, ack=y+1    ---> 服务端
"""
```

#### 5、应用层

### 其余补充

#### socket 抽象层

套接字，处理应用层以下的网络

#### dhcp

自动分配 `ip`

#### dns

相当于一个通讯录，根据域名去查询 `ip`

> `dns` 端口：53
> `web` 端口：80/443

常用的 `dns`

````python
"""
阿里：223.5.5.5    223.6.6.6
腾讯：119.29.29.29
百度：180.76.76.76
谷歌：8.8.8.8
"""
```
